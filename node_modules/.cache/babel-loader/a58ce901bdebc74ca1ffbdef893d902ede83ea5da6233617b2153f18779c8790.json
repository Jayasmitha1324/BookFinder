{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\admin\\\\Desktop\\\\Book_Finder\\\\book-finder-final\\\\book-finder\\\\src\\\\pages\\\\Home.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport SearchBar from '../components/SearchBar';\nimport BookCard from '../components/BookCard';\nimport BookDetailsModal from '../components/BookDetailsModal';\nimport { searchBooks } from '../api/openLibrary';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Home() {\n  _s();\n  const [query, setQuery] = useState('');\n  const [filters, setFilters] = useState({\n    author: '',\n    year: '',\n    language: ''\n  });\n  const [results, setResults] = useState([]);\n  const [numFound, setNumFound] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [page, setPage] = useState(1);\n  const [selected, setSelected] = useState(null);\n  async function doSearch(currentQuery = query, currentFilters = filters, p = 1) {\n    if (!currentQuery.trim()) {\n      setError('Please enter a search term.');\n      return;\n    }\n    setError('');\n    setLoading(true);\n    try {\n      const data = await searchBooks({\n        q: currentQueryquery,\n        author: currentFilters.author,\n        year: currentFilters.year,\n        language: currentFilters.language,\n        page: p\n      });\n      let docs = data.docs || [];\n\n      // 🌍 Apply robust client-side language filter\n      if (currentFilters.language) {\n        docs = docs.filter(book => Array.isArray(book.language) && book.language.some(lang => lang.toLowerCase().includes(currentFilters.language.toLowerCase())));\n      }\n\n      // ✅ Update results before checking for empty results\n      setResults(docs);\n      setNumFound(data.numFound || 0);\n      setPage(p);\n\n      // Only show error if there are truly no docs\n      if (docs.length === 0) {\n        setError('No results found for this language or filters.');\n      }\n    } catch (e) {\n      setError(e.message || 'Failed to fetch data.');\n    } finally {\n      setLoading(false);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(SearchBar, {\n      query: query,\n      onQueryChange: setQuery,\n      filters: filters,\n      onFiltersChange: setFilters,\n      onSearch: () => doSearch(1)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"notice error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 17\n    }, this), !error && !loading && results.length === 0 && query.trim() && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"notice\",\n      children: \"No results found.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"notice\",\n      children: \"Loading\\u2026\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid\",\n      children: results.map(b => /*#__PURE__*/_jsxDEV(BookCard, {\n        book: b,\n        onOpen: () => setSelected(b)\n      }, `${b.key}_${b.cover_i || ''}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), numFound > results.length && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pagination\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => doSearch(page - 1),\n        disabled: page <= 1,\n        children: \"Prev\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"Page \", page]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => doSearch(page + 1),\n        children: \"Next\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }, this), selected && /*#__PURE__*/_jsxDEV(BookDetailsModal, {\n      book: selected,\n      onClose: () => setSelected(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n}\n_s(Home, \"dHabsimCQ6iTWb5AOp6QfB+l+FI=\");\n_c = Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useState","SearchBar","BookCard","BookDetailsModal","searchBooks","jsxDEV","_jsxDEV","Home","_s","query","setQuery","filters","setFilters","author","year","language","results","setResults","numFound","setNumFound","loading","setLoading","error","setError","page","setPage","selected","setSelected","doSearch","currentQuery","currentFilters","p","trim","data","q","currentQueryquery","docs","filter","book","Array","isArray","some","lang","toLowerCase","includes","length","e","message","children","onQueryChange","onFiltersChange","onSearch","fileName","_jsxFileName","lineNumber","columnNumber","className","map","b","onOpen","key","cover_i","onClick","disabled","onClose","_c","$RefreshReg$"],"sources":["C:/Users/admin/Desktop/Book_Finder/book-finder-final/book-finder/src/pages/Home.js"],"sourcesContent":["import React, { useState } from 'react';\nimport SearchBar from '../components/SearchBar';\nimport BookCard from '../components/BookCard';\nimport BookDetailsModal from '../components/BookDetailsModal';\nimport { searchBooks } from '../api/openLibrary';\n\nexport default function Home(){\n  const [query, setQuery] = useState('');\n  const [filters, setFilters] = useState({ author: '', year: '',language: '' });\n  const [results, setResults] = useState([]);\n  const [numFound, setNumFound] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [page, setPage] = useState(1);\n  const [selected, setSelected] = useState(null);\n\n  async function doSearch(currentQuery = query, currentFilters = filters, p = 1){\n    if (!currentQuery.trim()) {\n      setError('Please enter a search term.');\n      return;\n    }\n    setError('');\n    setLoading(true);\n    try {\n      const data = await searchBooks({\n        q: currentQueryquery,\n        author: currentFilters.author,\n        year: currentFilters.year,\n        language: currentFilters.language,\n        page: p,\n      });\n\n      let docs = data.docs || [];\n\n    // 🌍 Apply robust client-side language filter\n      if (currentFilters.language) {\n        docs = docs.filter(\n          (book) =>\n            Array.isArray(book.language) &&\n            book.language.some(\n              (lang) =>\n                lang.toLowerCase().includes(currentFilters.language.toLowerCase())\n            )\n        );\n      }\n\n      // ✅ Update results before checking for empty results\n      setResults(docs);\n      setNumFound(data.numFound || 0);\n      setPage(p);\n\n      // Only show error if there are truly no docs\n      if (docs.length === 0) {\n        setError('No results found for this language or filters.');\n      }\n    } catch (e) {\n      setError(e.message || 'Failed to fetch data.');\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div>\n      <SearchBar\n        query={query}\n        onQueryChange={setQuery}\n        filters={filters}\n        onFiltersChange={setFilters}\n        onSearch={() => doSearch(1)}\n      />\n\n      {error && <div className=\"notice error\">{error}</div>}\n      {!error && !loading && results.length === 0 && query.trim() && (\n        <div className=\"notice\">No results found.</div>\n      )}\n      {loading && <div className=\"notice\">Loading…</div>}\n\n      <div className=\"grid\">\n        {results.map(b => (\n          <BookCard key={`${b.key}_${b.cover_i || ''}`} book={b} onOpen={() => setSelected(b)} />\n        ))}\n      </div>\n\n      {numFound > results.length && (\n        <div className=\"pagination\">\n          <button onClick={() => doSearch(page - 1)} disabled={page <= 1}>Prev</button>\n          <span>Page {page}</span>\n          <button onClick={() => doSearch(page + 1)}>Next</button>\n        </div>\n      )}\n\n      {selected && (\n        <BookDetailsModal book={selected} onClose={() => setSelected(null)} />\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}